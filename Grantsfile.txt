import React, { useState, useEffect } from 'react'; import { Trash2, Plus, Save } from 'lucide-react'; export default function SpiritTeamTracker() { const [teams, setTeams] = useState([]); const [currentTeam, setCurrentTeam] = useState({ name: '', primary: { name: '', slots: 1 }, supports: [] }); const [loading, setLoading] = useState(true); useEffect(() => { loadTeams(); }, []); useEffect(() => { if (!loading) { saveTeams(); } }, [teams, loading]); const loadTeams = async () => { try { const result = await window.storage.get('spirit-teams'); if (result && result.value) { setTeams(JSON.parse(result.value)); } } catch (error) { console.log('No saved teams found or error loading:', error); } setLoading(false); }; const saveTeams = async () => { try { await window.storage.set('spirit-teams', JSON.stringify(teams)); } catch (error) { console.error('Error saving teams:', error); } }; const addSupportSpirit = () => { if (currentTeam.supports.length < 3) { setCurrentTeam({ ...currentTeam, supports: [...currentTeam.supports, { name: '', slots: 1 }] }); } }; const removeSupportSpirit = (index) => { setCurrentTeam({ ...currentTeam, supports: currentTeam.supports.filter((_, i) => i !== index) }); }; const updatePrimary = (field, value) => { setCurrentTeam({ ...currentTeam, primary: { ...currentTeam.primary, [field]: value } }); }; const updateSupport = (index, field, value) => { const newSupports = [...currentTeam.supports]; newSupports[index] = { ...newSupports[index], [field]: value }; setCurrentTeam({ ...currentTeam, supports: newSupports }); }; const getTotalSlotsUsed = () => { return currentTeam.supports.reduce((sum, s) => sum + parseInt(s.slots), 0); }; const canAddSupport = () => { const slotsUsed = getTotalSlotsUsed(); return slotsUsed < currentTeam.primary.slots && currentTeam.supports.length < 3; }; const saveTeam = () => { if (currentTeam.primary.name && currentTeam.name) { setTeams([...teams, { ...currentTeam, id: Date.now() }]); setCurrentTeam({ name: '', primary: { name: '', slots: 1 }, supports: [] }); } }; const deleteTeam = (id) => { setTeams(teams.filter(t => t.id !== id)); }; const SlotIndicator = ({ total, used }) => ( <div className="flex gap-1"> {[...Array(total)].map((_, i) => ( <div key={i} className={`w-6 h-6 rounded ${ i < used ? 'bg-blue-500' : 'bg-gray-300' }`} /> ))} </div> ); if (loading) { return ( <div className="min-h-screen bg-gradient-to-br from-red-500 via-orange-500 to-yellow-500 flex items-center justify-center"> <div className="text-white text-2xl font-bold">Loading...</div> </div> ); } return ( <div className="min-h-screen bg-gradient-to-br from-red-500 via-orange-500 to-yellow-500 p-4"> <div className="max-w-md mx-auto"> <h1 className="text-3xl font-bold text-white text-center mb-6 drop-shadow-lg"> Spirit Team Tracker </h1> <div className="bg-white rounded-lg shadow-xl p-5 mb-6"> <h2 className="text-xl font-bold mb-4 text-gray-800">Create Team</h2> <input type="text" placeholder="Team Name" value={currentTeam.name} onChange={(e) => setCurrentTeam({ ...currentTeam, name: e.target.value })} className="w-full p-3 border-2 border-gray-300 rounded-lg mb-4 focus:border-blue-500 focus:outline-none" /> <div className="bg-red-50 p-4 rounded-lg mb-4"> <h3 className="font-bold text-red-700 mb-3">Primary Spirit</h3> <input type="text" placeholder="Primary Spirit Name" value={currentTeam.primary.name} onChange={(e) => updatePrimary('name', e.target.value)} className="w-full p-2 border-2 border-red-200 rounded mb-3 focus:border-red-500 focus:outline-none" /> <div className="flex items-center gap-3"> <span className="text-sm font-medium text-gray-700">Slots:</span> {[1, 2, 3].map(num => ( <button key={num} onClick={() => { updatePrimary('slots', num); setCurrentTeam({ ...currentTeam, primary: { ...currentTeam.primary, slots: num }, supports: [] }); }} className={`px-4 py-2 rounded-lg font-bold ${ currentTeam.primary.slots === num ? 'bg-red-500 text-white' : 'bg-gray-200 text-gray-700' }`} > {num} </button> ))} </div> </div> <div className="bg-blue-50 p-4 rounded-lg mb-4"> <div className="flex justify-between items-center mb-3"> <h3 className="font-bold text-blue-700">Support Spirits</h3> <SlotIndicator total={currentTeam.primary.slots} used={getTotalSlotsUsed()} /> </div> {currentTeam.supports.map((support, index) => ( <div key={index} className="bg-white p-3 rounded-lg mb-2 border-2 border-blue-200"> <input type="text" placeholder="Support Spirit Name" value={support.name} onChange={(e) => updateSupport(index, 'name', e.target.value)} className="w-full p-2 border border-gray-300 rounded mb-2 focus:border-blue-500 focus:outline-none" /> <div className="flex items-center justify-between"> <div className="flex items-center gap-2"> <span className="text-sm font-medium text-gray-700">Slots:</span> {[1, 2, 3].map(num => ( <button key={num} onClick={() => updateSupport(index, 'slots', num)} disabled={getTotalSlotsUsed() - support.slots + num > currentTeam.primary.slots} className={`px-3 py-1 rounded font-bold text-sm ${ support.slots === num ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700 disabled:opacity-30' }`} > {num} </button> ))} </div> <button onClick={() => removeSupportSpirit(index)} className="text-red-500 p-1" > <Trash2 size={18} /> </button> </div> </div> ))} <button onClick={addSupportSpirit} disabled={!canAddSupport()} className="w-full py-2 bg-blue-500 text-white rounded-lg font-bold flex items-center justify-center gap-2 disabled:opacity-30 disabled:cursor-not-allowed mt-2" > <Plus size={18} /> Add Support Spirit </button> </div> <button onClick={saveTeam} disabled={!currentTeam.primary.name || !currentTeam.name} className="w-full py-3 bg-green-500 text-white rounded-lg font-bold flex items-center justify-center gap-2 disabled:opacity-30 disabled:cursor-not-allowed" > <Save size={20} /> Save Team </button> </div> {teams.length > 0 && ( <div className="bg-white rounded-lg shadow-xl p-5"> <h2 className="text-xl font-bold mb-4 text-gray-800">Saved Teams</h2> {teams.map(team => ( <div key={team.id} className="bg-gray-50 p-4 rounded-lg mb-3 border-2 border-gray-200"> <div className="flex justify-between items-start mb-3"> <h3 className="font-bold text-lg text-gray-800">{team.name}</h3> <button onClick={() => deleteTeam(team.id)} className="text-red-500" > <Trash2 size={20} /> </button> </div> <div className="bg-red-100 p-3 rounded mb-2"> <p className="font-bold text-red-700 text-sm mb-1">Primary</p> <p className="text-gray-800">{team.primary.name}</p> <SlotIndicator total={team.primary.slots} used={team.primary.slots} /> </div> {team.supports.length > 0 && ( <div className="bg-blue-100 p-3 rounded"> <p className="font-bold text-blue-700 text-sm mb-2">Supports</p> {team.supports.map((support, i) => ( <div key={i} className="flex justify-between items-center mb-1"> <p className="text-gray-800">{support.name}</p> <SlotIndicator total={support.slots} used={support.slots} /> </div> ))} </div> )} </div> ))} </div> )} </div> </div> ); }